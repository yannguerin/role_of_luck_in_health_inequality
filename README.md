# The Role of Luck in Health Inequality

## Installation

### Environment

Clone this repository onto your machine.

We've used conda for our virtual environment. Please ensure conda is installed on your machine (see [Install Conda](https://docs.conda.io/projects/conda/en/stable/#install))

Create a virtual environment using conda, and install the required packages, by following this command:

```bash
conda create -n health_inequity_simulation --file=requirements.txt
```

Activate your environment:

```bash
conda activate health_inequity_simulation
```

You should now see (health_inequity_simulation) at the start of your terminal input.

## Calibration

The calibration process calibrates the model's parameters based on empirical data. We use the black-it library for the calibration. The calibration process samples from the parameter space quasi-randomly to efficiently explore the parameter space.

See the run_calibration.py for options that can be modified to increase or decrease the amount of the parameter space that is explored during the calibration process.

To run the calibration with the current parameters, run the following command:

```bash
python3 run_calibration.py
```

This process may take several hours to complete. 

Once the script is completed, see the results/calibration_results folder to find the calibrated parameters. Then, in the calibrated_parameters.py file, modify the namedtuple object with the calibrated parameters.

## Simulations

To run the simulations created to exlore modifications to the base model, run build_interactive_results.py file using the following command:

```bash
python3 build_interactive_results.py
```

The interactive results, in HTML format, can be found in the results/interactive_results folder. There are two interactive files: main_simulation_results.html, and individual_simulation_results.html.

And, to create the simulation results datasets, run the build_simulation_datasets.py file using the following command:

```bash
python3 build_simulation_datasets.py
```

## Manuscript Figures

To recreate the figures used in the manuscript, run all the notebook manuscript_results.ipynb. This notebook relies on the simulation datasets generated by the build_simulation_datasets.py script. 